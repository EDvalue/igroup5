<!DOCTYPE html>
<html>
<head>

    <link href="../CSS/LogIn.css" rel="stylesheet" />
    <meta charset="utf-8" />
    <title></title>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../Scripts/ajaxCalls.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <script>

        $(document).ready(function () {


            $("#connect").click(function () {

                Connection = {
                    "Email": $("#userName").val(),
                    "Password": $("#password").val()
                }

                ajaxCall("PUT", "../api/EDvalue/Conect", JSON.stringify(Connection), ConectSuccess, ConectError)

            });

            function ConectSuccess(data) {
                console.log(data);
                if (data.Name) {
                    localStorage["user"] = JSON.stringify(data);
                    user = JSON.parse(localStorage["user"])
                    console.log(user)
                    console.log(user.IsCompleteIquizz)
                    if (data.hasOwnProperty('IsEditor')) {
                        localStorage['userMode'] = "teacher";
                        location.replace("teacherDahBoard.html");
                    } else if (user.IsCompleteIquizz) {
                        if (user.IsCompleteIquizz == true) {
                            localStorage['userMode'] = "student";
                            location.replace("studentDashboard.html");
                        }
                        else {
                            localStorage['userMode'] = "student";
                            location.replace ("intelligencequiz.html");
                        }

                    } else {
                        localStorage['userMode'] = "Admin";
                        location.replace("systemManager.html")
                    }
                } else {
                    swal("wrong user name or password❌")
                }

            }

            function ConectError(err) {
                console.log(err)
            }

        });

    </script>


</head>
<body dir="rtl">
    <div id="container">

        <div id="header">
            <!--<h1>ברוכים הבאים</h1>-->
            <img src="../images/EDvalueBig.png" />
        </div>
       
         <div id="main">
            <div id="details" class="col-9 col-sm-7 col-md-6 col-lg-4">
                <div id="conect_deatails">
                    <div id="user">
                        <p>שם משתמש:</p><input class="form-control form-control-sm" type="text" id="userName"/>
                    </div>
                    <div id="passDIV">
                        <p>סיסמא:</p><input class="form-control form-control-sm" type="password" id="password"/>
                    </div>
                    <a  id="passForget" onclick="">forget password</a>
                </div>
                <div id="button_deatails">

                    <img src="../images/in-person.png" />
                    <button id="connect">Connect</button>

                </div>


            </div>
        </div>
            

    </div>
</body>
</html>