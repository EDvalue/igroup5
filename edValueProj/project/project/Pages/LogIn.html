<!DOCTYPE html>
<html>
<head>

    <link href="../CSS/LogIn.css" rel="stylesheet" />
    <meta charset="utf-8" />
    <title></title>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="../Scripts/ajaxCalls.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <script>

        $(document).ready(function () {

            $("#conect").click(function () {

                Connection = {
                    "Email": $("#userName").val(),
                    "Password": $("#password").val()
                }

                ajaxCall("PUT", "../api/EDvalue/Conect", JSON.stringify(Connection), ConectSuccess, ConectError)

            });

            function ConectSuccess(data) {
                console.log(data);
                if (data.IdNumber) {
                    localStorage["user"] = JSON.stringify(data);
                    user = JSON.parse(localStorage["user"])
                    console.log(user)
                    console.log(user.IsCompleteIquizz)
                    if (data.hasOwnProperty('IsEditor')) {
                        localStorage['userMode'] = "teacher";
                        window.open("teacherDahBoard.html");
                    } else {
                        if (user.IsCompleteIquizz == true) {
                            localStorage['userMode'] = "student";
                            window.open("studentDashboard.html");
                        }
                        else {
                            localStorage['userMode'] = "student";
                            window.open("intelligencequiz.html");
                        }
                            
                    }
                } else {
                    swal("wrong user name or password❌")
                }

            }

            function ConectError(err) {
                console.log(err)
            }

        });

    </script>


</head>
<body dir="rtl">
    <div id="container">

        <div id="header">
            <!--<h1>ברוכים הבאים</h1>-->
            <img src="../images/EDvalueBig.png" />
        </div>
        <div id="login">

            <div id="details">
                <div class="row" id="insertRow">
                    <span class="col-lg-4"> שם משתמש</span><input id="userName" class="form-control col-lg-8" type="text" />
                </div>

                <div class="row" id="insertRow">
                    <span class="col-lg-4"> סיסמא</span> <input id="password" class="col-lg-8 form-control" type="password" />
                </div>
                <div class="row">
                    <button id="conect">התחבר</button>
                </div>

            </div>
            <br />

            <a href="studentDashboard.html">  Student</a>
            <a href="teacherDahBoard.html">  Teacher</a>
            <a href="systemManager.html">  Admin</a>

        </div>
    </div>
</body>
</html>