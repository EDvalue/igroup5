<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8" />
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
    <link href="../CSS/showQuiz.css" rel="stylesheet" />

    <script src="//cdn.ckeditor.com/4.14.0/standard/ckeditor.js"></script>
    <title></title>
    
    <script>
        var str;
        var el
        var perform_showQuiz_mode;


        function init() {

            if (localStorage["userMode"]) {

                perform_showQuiz_mode = localStorage["userMode"];
            }

            quizString = "";
            document.getElementsByTagName('body')[0].innerHTML = ""
            el = JSON.parse(localStorage['quiz']);
            quizString += `<div id='QuizTitle'><h1>${el.Title}</h1> </div>
                        <div id='main'>`
            for (qu in el.Question) {

                quizString += `<form id=quizForm><div id='${qu}' class='${el.Question[qu].Type}'>`
                if (el.Question[qu].ImgLink != "" || el.Question[qu].VideoLink != "") {
                    quizString += `<div id="extraData"></div>`
                }
                quizString += `<div id="Question_content"><p>${el.Question[qu].Content}</p></div>`
                 //quizString += `<div id="Question_answer">`
                if (el.Question[qu].Type == 'A') {
                   quizString += `<div id="Question_answer">`
                    for (y in el.Question[qu].Answer) {
                        if (el.Question[qu].Answer[y].IsRight) {
                            quizString += `<div id="AmericanAmswerBlock">`
                            if (perform_showQuiz_mode == 'teacher') {

                                quizString += `<span>${parseInt(y) + 1}</span><input type="checkbox" checked name="chk"${qu}/> <p>${el.Question[qu].Answer[y].Content}</p>`
                            } else {

                                 quizString += `<span>${parseInt(y) + 1}</span><input type="checkbox"  name="chk"${qu}/> <p>${el.Question[qu].Answer[y].Content}</p>`
                            }
                                                            
                                     quizString+= `</div>`
                        } else {
                            quizString += `<div id="AmericanAmswerBlock">
                                 <span>${parseInt(y) + 1}</span><input type="checkbox"  name="chk"${qu}/> <p>${el.Question[qu].Answer[y].Content}</p>
                                 </div>`
                        }

                    }

                    quizString += `</div>`;
                } else if (el.Question[qu].Type == 'O') {

                    quizString += `<div id="OpenAnswerBlock"><textarea id="textarea" rows='7' cols='100'></textarea></div>`
                } else if (el.Question[qu].Type == 'U') {

                    quizString += `<div id='OpenUploadBlock'><input type='file' /></div>`

                } else if (el.Question[qu].Type == 'M') {

                    for (y in el.Question[qu].Answer) {

                        if (el.Question[qu].Answer[y].IsRight) {
                            quizString += `<div id="AmericanAmswerBlock">`
                            if (perform_showQuiz_mode == "teacher") {
                                quizString += `<span>${parseInt(y) + 1}</span><input type="checkbox" checked /> <p>${el.Question[qu].Answer[y].Content}</p>`
                            } else {
                                quizString += `<span>${parseInt(y) + 1}</span><input type="checkbox"  /> <p>${el.Question[qu].Answer[y].Content}</p>`
                            }
                                                            
                            quizString +=  `</div>`
                        } else {
                            quizString += `<div id="AmericanAmswerBlock">
                                 <span>${parseInt(y) + 1}</span><input type="checkbox" /> <p>${el.Question[qu].Answer[y].Content}</p>
                                 </div>`
                        }

                    }


                }

                
               
                quizString += '</div>'

                if (perform_showQuiz_mode == "student") {
                    quizString+=`<div id=submitDIV><input type="submit" class="btn info-btn" /></div>`
                }
            }
            quizString += '</div></form>'
            document.getElementsByTagName('body')[0].innerHTML += quizString;
             CKEDITOR.replace('textarea');

            connectCHK();
        }





        function connectCHK() {
            $("input:checkbox").on('click', function () {
                // in the handler, 'this' refers to the box clicked on
                var $box = $(this);
                if ($box.is(":checked")) {
                    // the name of the box is retrieved using the .attr() method
                    // as it is assumed and expected to be immutable
                    var group = "input:checkbox[name='" + $box.attr("name") + "']";
                    // the checked state of the group/box on the other hand will change
                    // and the current value is retrieved using .prop() method
                    $(group).prop("checked", false);
                    $box.prop("checked", true);
                } else {
                    $box.prop("checked", false);
                }
            });
        }


    </script>

</head>
<body dir="rtl" onload="init()">
    <div id="bg"></div>
    <div id="container">
        <div id="header">
            <h1>QUIZ</h1>
        </div>

    </div>
</body>
</html>